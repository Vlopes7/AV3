// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
Â  provider = "prisma-client-js"
Â  previewFeatures = ["driverAdapters"]
}

datasource db {
Â  provider = "mysql"
Â  url = env("DATABASE_URL")
}

enum Hierarquia {
Â  Administrador
Â  Engenheiro
Â  Operador
}

enum TipoAeronave {
Â  Comercial
Â  Militar
}

enum StatusPeca {
Â  Em_producao
Â  Em_transporte
Â  Pronta_para_uso
}

enum TipoPeca {
Â  Nacional
Â  Importada
}

enum StatusProducao {
Â  Pendente
Â  Em_andamento
Â  Concluido
}

enum TipoTeste {
Â  Eletrico
Â  Hidraulico
Â  Aerodinamico
}

enum ResultadoTeste {
Â  Aprovado
Â  Reprovado
}

model Endereco {
Â  id Â  Â  Â  Â  Â  Â Int Â  Â  Â  Â @id @default(autoincrement())
Â  rua Â  Â  Â  Â  Â  String Â  Â  @db.VarChar(100)
Â  numero Â  Â  Â  Â Int
Â  bairro Â  Â  Â  Â String Â  Â  @db.VarChar(50)
Â  cidade Â  Â  Â  Â String Â  Â  @db.VarChar(50)

Â  funcionarioId Int? Â  Â  Â  @unique
Â  funcionario Â  Funcionario? @relation(fields: [funcionarioId], references: [id])
}

model Telefone {
Â  id Â  Â  Â  Â  Â  Â Int Â  Â  Â  Â @id @default(autoincrement())
Â  ddd Â  Â  Â  Â  Â  String Â  Â  @db.VarChar(3)
Â  numero Â  Â  Â  Â String Â  Â  @db.VarChar(10)

Â  funcionarioId Int? Â  Â  Â  @unique
Â  funcionario Â  Funcionario? @relation(fields: [funcionarioId], references: [id])
}

model Funcionario {
Â  id Â  Â  Â  Â  Â  Â  Â  Â  Int Â  Â  Â  Â @id @default(autoincrement())
Â  nome Â  Â  Â  Â  Â  Â  Â  String Â  Â  @db.VarChar(100)
Â  cpf Â  Â  Â  Â  Â  Â  Â  Â String Â  Â  @unique @db.VarChar(14)
Â  cargo Â  Â  Â  Â  Â  Â  Â Hierarquia
Â  login Â  Â  Â  Â  Â  Â  Â String Â  Â  @unique @db.VarChar(100)
Â  senha Â  Â  Â  Â  Â  Â  Â String

Â  endereco Â  Â  Â  Â  Â  Endereco? Â 
Â  telefone Â  Â  Â  Â  Â  Telefone? Â 

Â  etapas_trabalhadas EtapaFuncionario[]
Â  user Â  Â  Â  Â  Â  Â  Â  User?
}


model Aeronave {
Â  codigo Â  Â  Int Â  Â  Â  Â  Â  @id @unique
Â  modelo Â  Â  String Â  Â  Â  Â @db.VarChar(100)
Â  tipo Â  Â  Â  TipoAeronave
Â  capacidade Int
Â  autonomia Â Int
Â  
Â  pecas Â  Â  Â Peca[]
Â  etapas Â  Â  Etapa[]
Â  // O campo 'testes' Json? foi removido e substituÃ­do pelo Modelo Teste
Â  testes Â  Â  Teste[] // RelaÃ§Ã£o 1:N (Uma Aeronave tem muitos Testes)
}

model Peca {
Â  id Â  Â  Â  Â  Int Â  Â  Â  Â @id @default(autoincrement())
Â  nome Â  Â  Â  String Â  Â  @db.VarChar(100)
Â  tipo Â  Â  Â  TipoPeca
Â  fornecedor String Â  Â  @db.VarChar(100)
Â  status Â  Â  StatusPeca
Â  
Â  aeronaveId Int
Â  aeronave Â  Aeronave Â  @relation(fields: [aeronaveId], references: [codigo])
}

model Etapa {
Â  id Â  Â  Â  Â  Â  Int Â  Â  Â  Â  Â  Â  Â @id @default(autoincrement())
Â  nome Â  Â  Â  Â  String Â  Â  Â  Â  Â  @db.VarChar(100)
Â  dataPrevista DateTime Â  Â  Â  Â  @db.Date
Â  status Â  Â  Â  StatusProducao
Â  
Â  aeronaveId Â  Int
Â  aeronave Â  Â  Aeronave Â  Â  Â  Â  @relation(fields: [aeronaveId], references: [codigo])
Â  
Â  funcionarios EtapaFuncionario[]
}

// ðŸ†• NOVO MODELO PARA REGISTRAR TESTES
model Teste {
    id          Int           @id @default(autoincrement())
    tipo        TipoTeste     
    data        DateTime      @default(now()) // Data e hora do registro
    resultado   ResultadoTeste
    
    // RelaÃ§Ã£o com a Aeronave
    aeronaveId  Int
    aeronave    Aeronave      @relation(fields: [aeronaveId], references: [codigo])
}
// ------------------------------

model EtapaFuncionario {
Â  etapaId Â  Â  Â  Int
Â  funcionarioId Int
Â  
Â  etapa Â  Â  Â  Â  Etapa Â  Â  Â @relation(fields: [etapaId], references: [id])
Â  funcionario Â  Funcionario @relation(fields: [funcionarioId], references: [id])
Â  
Â  @@id([etapaId, funcionarioId])
}

model User {
Â  id Â  Â  Â  Â  Â  String Â  Â @id @default(uuid())
Â  email Â  Â  Â  Â String Â  Â @unique
Â  password Â  Â  String
Â  funcionario Â Funcionario? @relation(fields: [funcionarioId], references: [id])
Â  funcionarioId Int? Â  Â @unique 
Â  createdAt Â  Â DateTime Â @default(now())
Â  updatedAt Â  Â DateTime Â @updatedAt
}